name: Medical News Bot

on:
  schedule:
    - cron: '0 20 * * 0'  # Segunda, 17h Brasília (20h UTC)
    - cron: '0 16 * * 1'  # Terça, 13h Brasília (16h UTC)
    - cron: '0 14 * * 2'  # Quarta, 11h Brasília (14h UTC)
    - cron: '0 18 * * 3'  # Quinta, 15h Brasília (18h UTC)
  workflow_dispatch:

jobs:
  post:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Install dependencies
      run: |
        pip install feedparser requests python-dotenv beautifulsoup4 schedule instagrapi deep-translator langdetect Pillow
    
        - name: Run bot
      env:
        INSTAGRAM_USERNAME: ${{ secrets.INSTAGRAM_USERNAME }}
        INSTAGRAM_PASSWORD: ${{ secrets.INSTAGRAM_PASSWORD }}
        PYTHONUNBUFFERED: 1
      run: |
        echo "Testando credenciais..."
        echo "Username definido: ${{ secrets.INSTAGRAM_USERNAME != '' }}"
        echo "Password definido: ${{ secrets.INSTAGRAM_PASSWORD != '' }}"
        python main.py --now

